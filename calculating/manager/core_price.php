<?phpfunction getSeopult($seopult_id, $num){	$seoPult = new seoPult();	$seoPult->connect();	$ans = $seoPult->getAllPrice($seopult_id,$num);	//echo $ans;	$pattern = "#<input type='hidden' name='keyword_recbudget\[[\d]+\]' value='([\d]+)' id='keyword_recbudget\[[\d]+\]'>#is";		preg_match_all($pattern, $ans, $out);	$price = $out[1][0];			//echo $price;		$objResponse = new xajaxResponse();	$objResponse->assign("answ_".$seopult_id,"innerHTML",$price );	$objResponse->script("addCount({$price})");	return $objResponse;}//getSeopult(75185048,47208927);//key_ids=75141618&rand_num=44613961//38887404//11115876//<input type='hidden' name='keyword_recbudget[38887404]' value='34000' id='keyword_recbudget[38887404]'>//getSeopult(38887404,11115876);	include_once ROOT.'/fmake/libs/xajax/xajax_core/xajax.inc.php';	$xajax = new xajax();	$xajax->registerFunction("getSeopult");	$xajax->configure('javascript URI','/fmake/libs/xajax/');	$xajax->register(XAJAX_FUNCTION,"getSeopult");	$xajax->processRequest();		$globalTemplateParam->set('xajax',$xajax);		$modul->template =  "manager/core_price.tpl";	switch ($request->action){		case 'add_words':			$ind = 0;			$arr = explode("\n",$_REQUEST["word"]);						foreach ($arr as $ar){				if(!$ar)continue;				$query[$ind++] = trim($ar);			}								$seoPult = new seoPult();				$seoPult->connect();				//очистка старых запросов				$seoPult->deleteWords($seoPult->getIdWords());								$seoPult->addWords($query);				$ids = ($seoPult->getIdWords());			foreach ($ids as $key=> $id){				$querys[$key]['query'] = $query[$key];				$querys[$key]['id'] = $id;								$seoPult->addParam('query',$query[$key]);				$seoPult->addParam('seopult_id',$id);				$seoPult->newItem();			}			$block = "office/seopult/word2";		break;		case 'add_words_from_one':								$mas = ($_REQUEST['mas']);			$url = $_REQUEST['url'];			$ind = 0;						//echo $url;			foreach ($mas as $ar){				if(!$ar['query'])continue;				$counts[$ind] = $ar['count'];				$query[$ind++] = trim($ar['query']);							}				//printAr($query);				$seoPult = new seoPult();				$seoPult->connect();				//очистка старых запросов				$seoPult->deleteWords($seoPult->getIdWords());								$seoPult->addWords($query);				$ids = ($seoPult->getIdWords());			foreach ($ids as $key=> $id){				$querys[$key]['query'] = $query[$key];				$querys[$key]['id'] = $id;				$querys[$key]['count'] = $counts[$key];				if($url){					$searchObj = new searchSystems_Yandex($query[$key],$url,213);					$querys[$key]['pos'] = $searchObj->getPosition();				}								$seoPult->addParam('query',$query[$key]);				$seoPult->addParam('seopult_id',$id);				$seoPult->newItem();			}			//printAr($querys);			//exit;			 $modul->template =  "manager/core_price.tpl";						if($request->google){				$modul->template =  "manager/core_price_2systems.tpl";			}			$globalTemplateParam->set('querys',$querys);		break;	}